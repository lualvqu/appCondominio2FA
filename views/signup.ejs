<!DOCTYPE html>
<html lang="pt-br">

<head>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title> Login </title>

    <!-- ==========  CSS Bootstrap Import Zone ========== -->
    <link rel="stylesheet" href="/stylesheets/bootstrap.min.css">
    <link rel="stylesheet" href="/stylesheets/bootstrap-grid.min.css">
    <!-- ========== CSS FontAwesome Import Zone ========== -->
    <link rel="stylesheet" href="/stylesheets/fontawesome.min.css">
    <!-- ========== CSS Personlizado Import Zone ========== -->
    <link rel="stylesheet" href="/stylesheets/styleApp.css">

</head>

<body>
    <div id="background-container" class="container-fluid h-100 d-flex align-items-center justify-content-center" style="background-image: url('/images/wallpaper.jpg');">
        <div id="form-box" class=" px-3 py-5 row" style="">
            <div id="img-div" class="col-md-4 col-sm-12 border-right">
                <h1 class="text-center" style="color:#495057">Criar conta</h1>
                <img class="img-size-100" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB3aWR0aD0iMTIwMCIgaGVpZ2h0PSIxMjAwIiB2aWV3Qm94PSIwIDAgMTIwMCAxMjAwIj48Zz48ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSg2MDAgNjAwKSBzY2FsZSgwLjY5IDAuNjkpIHJvdGF0ZSgwKSB0cmFuc2xhdGUoLTYwMCAtNjAwKSIgc3R5bGU9ImZpbGw6IzI1ODNkZjsiPjxzdmcgZmlsbD0iIzI1ODNkZiIgeG1sbnM6eD0iaHR0cDovL25zLmFkb2JlLmNvbS9FeHRlbnNpYmlsaXR5LzEuMC8iIHhtbG5zOmk9Imh0dHA6Ly9ucy5hZG9iZS5jb20vQWRvYmVJbGx1c3RyYXRvci8xMC4wLyIgeG1sbnM6Z3JhcGg9Imh0dHA6Ly9ucy5hZG9iZS5jb20vR3JhcGhzLzEuMC8iIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHZlcnNpb249IjEuMSIgeD0iMHB4IiB5PSIwcHgiIHZpZXdCb3g9IjAgMCAxMDAgMTAwIiBzdHlsZT0iZW5hYmxlLWJhY2tncm91bmQ6bmV3IDAgMCAxMDAgMTAwOyIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSI+PGc+PGcgaTpleHRyYW5lb3VzPSJzZWxmIj48cGF0aCBkPSJNOTEuNyw4Ny42VjE4LjZMMzYuOSw2Ljl2ODAuN0gzM1YyNy40TDguMywzMy42djU0SDIuNXY1LjVoOTV2LTUuNUg5MS43eiBNMTYuNSw0Mi42aDguNnY4LjZoLTguNlY0Mi42eiBNMTYuNSw1Ny41aDguNiAgICB2OC42aC04LjZWNTcuNXogTTE2LjUsNzIuM2g4LjZWODFoLTguNlY3Mi4zeiBNNzQuOSwyNy42aDguNnY4LjZoLTguNlYyNy42eiBNNzQuOSw0Mi41aDguNnY4LjZoLTguNlY0Mi41eiBNNzQuOSw1Ny40aDguNlY2NiAgICBoLTguNlY1Ny40eiBNNzQuOSw3Mi4zaDguNnY4LjZoLTguNlY3Mi4zeiBNNjAsMjcuNmg4LjZ2OC42SDYwVjI3LjZ6IE02MCw0Mi41aDguNnY4LjZINjBWNDIuNXogTTYwLDU3LjRoOC42VjY2SDYwVjU3LjR6ICAgICBNNDUuMSwyNy42aDguNnY4LjZoLTguNlYyNy42eiBNNDUuMSw0Mi41aDguNnY4LjZoLTguNlY0Mi41eiBNNDUuMSw1Ny40aDguNlY2NmgtOC42VjU3LjR6IE00NS4xLDcyLjNoOC42djguNmgtOC42VjcyLjN6ICAgICBNNjAsNzIuM2g4LjZ2MTUuM0g2MFY3Mi4zeiI+PC9wYXRoPjwvZz48L2c+PC9zdmc+PC9nPjwvZz48L3N2Zz4=">
            </div>
            <div id="form-div" class="col-md-8 col-sm-12 pl-5">
                <form id="cadastroForm" method="POST" action="/users/signup">
                    <div class="form-row">
                        <div class="form-group col-md-5">
                            <label class="sr-only" for="username">Username</label>
                            <div class="input-group mb-2">
                                <div class="input-group-prepend">
                                    <div class="input-icon fa fa-user"></div>
                                </div>
                                <input name="username" type="text" class="form-control input-icon" placeholder="Username" required/>
                            </div>
                        </div>
                        <div class="form-group col-md-7">
                            <label class="sr-only" for="email">Email</label>
                            <div class="input-group mb-2">
                                <div class="input-group-prepend">
                                    <div class="input-icon fa fa-envelope"></div>
                                </div>
                                <input name="email" type="email" class="form-control input-icon" placeholder="Email" required/>
                            </div>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group col-md-6">
                            <label class="sr-only" for="password">Senha</label>
                            <div class="input-group mb-2">
                                <div class="input-group-prepend">
                                    <div class="input-icon fa fa-lock"></div>
                                </div>
                                <input name="password" type="password" class="form-control input-icon" placeholder="Senha" required/>
                            </div>
                        </div>
                        <div class="form-group col-md-6">
                            <label class="sr-only" for="confirm-password">Confirmar senha</label>
                            <div class="input-group mb-2">
                                <div class="input-group-prepend">
                                    <div class="input-icon fa fa-check-circle"></div>
                                </div>
                                <input name="confirm-password" type="password" class="form-control input-icon"
                                    placeholder="Confirmar Senha"  required/>
                            </div>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group col-md-8">
                            <label class="sr-only" for="nome">Nome completo</label>
                            <div class="input-group mb-2">
                                <div class="input-group-prepend">
                                    <div class="input-icon fa fa-user-circle"></div>
                                </div>
                                <input name="nome" type="text" class="form-control input-icon" placeholder="Nome completo" required/>
                            </div>
                        </div>
                        <div class="form-group col-md-4">
                            <label class="sr-only" for="rg">RG</label>
                            <div class="input-group mb-2">
                                <div class="input-group-prepend">
                                    <div class="input-icon fa fa-id-card"></div>
                                </div>
                                <input name="rg" type="text" class="form-control input-icon" placeholder="RG" required/>
                            </div>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group col-md-5">
                            <label class="sr-only" for="dataNascimento">Data de nascimento</label>
                            <div class="input-group mb-2">
                                <div class="input-group-prepend">
                                    <div class="input-icon fa fa-calendar-alt"></div>
                                </div>
                                <input name="dataNascimento" type="text" class="form-control input-icon" placeholder="Data de nascimento" required/>
                            </div>
                        </div>
                        <div class="form-group col-md-7">
                            <label class="sr-only" for="telefone">Telefone</label>
                            <div class="input-group mb-2">
                                <div class="input-group-prepend">
                                    <div class="input-icon fa fa-phone"></div>
                                </div>
                                <input name="telefone" type="text" class="form-control input-icon" placeholder="Telefone" required/>
                            </div>
                        </div>
                    </div>

                    <div class="form-row">

                        <div class="form-group col-md-7">
                            <label class="sr-only" for="bloco">Bloco</label>
                            <div class="input-group mb-2">
                                <div class="input-group-prepend">
                                    <div class="input-icon fa fa-building"></div>
                                </div>
                                <select name="bloco" form="cadastroForm" class="form-control input-icon">
                                <option selected>Selecione seu bloco ...</option>
                                <% blocos.forEach(bloco => { %>
                                <option value="<%- bloco %>">
                                    <%- bloco %>
                                </option>
                                <% }); %>
                                </select>
                            </div>
                        </div>

                        <div class="form-group col-md-5">
                            <label class="sr-only" for="apartamento">Numero do apartamento</label>
                            <div class="input-group mb-2">
                                <div class="input-group-prepend">
                                    <div class="input-icon fa fa-sort-numeric-up"></div>
                                </div>
                                <input name="apartamento" type="text" class="form-control input-icon" placeholder="N&ordm; apartamento" required />
                            </div>
                        </div>
                    </div>
                    <div id="buton-group" class="row">
                        <div id="btn-faca-login" class="col-sm-12 col-md-8">
                            <a class="btn" href="/login">Fa√ßa login em vez disso</a>
                        </div>
                        <div class="col-sm-12 col-md-4">
                            <button type="submit" class="btn btn-primary w-100">Criar conta</button>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- ========== JS Bootstrap Import Zone ========== -->
    <script src="/javascripts/bootstrap.min.js"></script>
    <script src="/javascripts/bootstrap.bundle.min.js"></script>
    <!-- ========== JS JQuery Import Zone ========== -->
    <script src="/javascripts/jquery-3.3.1.min.js"></script>
    <script src="/javascripts/jquery.mask.min.js"></script>

    <script>
        $(document).ready(function () {
            $("input[name*='rg']").mask('00.000.000-0');
            $("input[name*='dataNascimento']").mask('00/00/0000');
            $("input[name*='apartamento']").mask('099');

            var SPMaskBehavior = function (val) {
                    return val.replace(/\D/g, '').length === 11 ? '(00) 00000-0000' : '(00) 0000-00009';
                },
                spOptions = {
                    onKeyPress: function (val, e, field, options) {
                        field.mask(SPMaskBehavior.apply({}, arguments), options);
                    }
                };
            $("input[name*='telefone']").mask(SPMaskBehavior, spOptions);

            $('#cadastroForm').submit(function (event) {
                event.preventDefault();
                
                var form = $(this);
                
                var data = form.serializeArray();

                data[5].value = $("input[name*='telefone']").cleanVal();
                data[7].value = $("input[name*='rg']").cleanVal();

                $.ajax({
                    type: form.attr('method'),
                    url: form.attr('action'),
                    data: data
                }).done(function (data) {
                    window.location = "/login";
                }).fail(function (data) {
                    alert(JSON.stringify(data));
                });
            });
        });
    </script>
</body>

</html>